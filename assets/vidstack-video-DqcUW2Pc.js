var $=Object.defineProperty;var N=(s,t,e)=>t in s?$(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var m=(s,t,e)=>(N(s,typeof t!="symbol"?t+"":t,e),e),E=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)};var i=(s,t,e)=>(E(s,t,"read from private field"),e?e.call(s):t.get(s)),n=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},c=(s,t,e,r)=>(E(s,t,"write to private field"),r?r.call(s,e):t.set(s,e),e);var l=(s,t,e)=>(E(s,t,"access private method"),e);import{r as q,aS as S,aT as A,aU as F,o as C,l as G,D as Y,G as _}from"./vidstack-DWQEfrPg-HzF3ULQC.js";import{H as j,a as z}from"./vidstack-CGXAe0PE-Cy5d3PcL.js";import{T as B,a as y}from"./vidstack-DXXgp8ue-8cpKpDdk.js";import"./vidstack-DSYpsFWk-D92Byy8J.js";import"./vidstack-player-BeI3DnBa.js";import"./app-Xuo_uAkj.js";var P,f,T,D,v,H;class J{constructor(t,e){n(this,T);n(this,v);n(this,P,void 0);n(this,f,void 0);c(this,P,t),c(this,f,e),t.textTracks.onaddtrack=l(this,T,D).bind(this),C(l(this,v,H).bind(this))}}P=new WeakMap,f=new WeakMap,T=new WeakSet,D=function(t){const e=t.track;if(!e||K(i(this,P),e))return;const r=new B({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});r[y.native]={track:e},r[y.readyState]=2,r[y.nativeHLS]=!0;let a=0;const V=U=>{if(e.cues)for(let b=a;b<e.cues.length;b++)r.addCue(e.cues[b],U),a++};V(t),e.oncuechange=V,i(this,f).textTracks.add(r,t),r.setMode(e.mode,t)},v=new WeakSet,H=function(){var t;i(this,P).textTracks.onaddtrack=null;for(const e of i(this,f).textTracks){const r=(t=e[y.native])==null?void 0:t.track;r!=null&&r.oncuechange&&(r.oncuechange=null)}};function K(s,t){return Array.from(s.children).find(e=>e.track===t)}var d,k,M,L,w,R,x;class Q{constructor(t,e){n(this,M);n(this,w);n(this,d,void 0);n(this,k,void 0);n(this,x,(t,e)=>{i(this,k).notify("picture-in-picture-change",t,e)});c(this,d,t),c(this,k,e),new _(t).add("enterpictureinpicture",l(this,M,L).bind(this)).add("leavepictureinpicture",l(this,w,R).bind(this))}get active(){return document.pictureInPictureElement===i(this,d)}get supported(){return A(i(this,d))}async enter(){return i(this,d).requestPictureInPicture()}exit(){return document.exitPictureInPicture()}}d=new WeakMap,k=new WeakMap,M=new WeakSet,L=function(t){i(this,x).call(this,!0,t)},w=new WeakSet,R=function(t){i(this,x).call(this,!1,t)},x=new WeakMap;var p,g,o,I,O;class W{constructor(t,e){n(this,I);n(this,p,void 0);n(this,g,void 0);n(this,o,"inline");c(this,p,t),c(this,g,e),G(t,"webkitpresentationmodechanged",l(this,I,O).bind(this))}get mode(){return i(this,o)}get supported(){return S(i(this,p))}async setPresentationMode(t){i(this,o)!==t&&i(this,p).webkitSetPresentationMode(t)}}p=new WeakMap,g=new WeakMap,o=new WeakMap,I=new WeakSet,O=function(t){var r;const e=i(this,o);c(this,o,i(this,p).webkitPresentationMode),(r=i(this,g).player)==null||r.dispatch(new Y("video-presentation-change",{detail:i(this,o),trigger:t})),["fullscreen","picture-in-picture"].forEach(a=>{(i(this,o)===a||e===a)&&i(this,g).notify(`${a}-change`,i(this,o)===a,t)})};var u;class X{constructor(t){n(this,u,void 0);c(this,u,t)}get active(){return i(this,u).mode==="fullscreen"}get supported(){return i(this,u).supported}async enter(){i(this,u).setPresentationMode("fullscreen")}async exit(){i(this,u).setPresentationMode("inline")}}u=new WeakMap;var h;class Z{constructor(t){n(this,h,void 0);c(this,h,t)}get active(){return i(this,h).mode==="picture-in-picture"}get supported(){return i(this,h).supported}async enter(){i(this,h).setPresentationMode("picture-in-picture")}async exit(){i(this,h).setPresentationMode("inline")}}h=new WeakMap;class ct extends j{constructor(e,r){super(e,r);m(this,"$$PROVIDER_TYPE","VIDEO");m(this,"airPlay");m(this,"fullscreen");m(this,"pictureInPicture");q(()=>{if(this.airPlay=new z(e,r),S(e)){const a=new W(e,r);this.fullscreen=new X(a),this.pictureInPicture=new Z(a)}else A(e)&&(this.pictureInPicture=new Q(e,r))},this.scope)}get type(){return"video"}setup(){super.setup(),F(this.video)&&new J(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),C(()=>{this.ctx.textRenderers.attachVideo(null)}),this.type==="video"&&this.ctx.notify("provider-setup",this)}get video(){return this.media}}export{ct as VideoProvider};
